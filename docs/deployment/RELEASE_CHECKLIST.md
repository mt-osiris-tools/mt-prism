# MT-PRISM Release Checklist

**Purpose**: Ensure all required assets are included in GitHub Releases for curl installer

## Pre-Release Checklist

### Code Quality
- [ ] All tests passing (npm test)
- [ ] No TypeScript errors (npm run build)
- [ ] Linting clean (npm run lint)
- [ ] Version bumped in package.json

### Documentation
- [ ] CHANGELOG.md updated with release notes
- [ ] README.md reflects new features
- [ ] Breaking changes documented
- [ ] Migration guide updated (if needed)

## GitHub Release Assets

### Required Files

1. **Source tarball** (auto-generated by GitHub)
   - Format: `mt-prism-{version}.tar.gz`
   - Contains: Complete source code

2. **Pre-built package** (manual upload)
   - Run: `npm run build`
   - Create: `tar -czf mt-prism-{version}-dist.tar.gz dist/ package.json .env.example README.md LICENSE`
   - Size: ~50KB (dist only)

3. **Checksum file** (manual upload)
   - Generate: `shasum -a 256 mt-prism-{version}-dist.tar.gz > mt-prism-{version}-dist.tar.gz.sha256`
   - Purpose: Install script verification

### Release Process

```bash
# 1. Bump version
npm version patch|minor|major

# 2. Build distributable
npm run build

# 3. Create tarball
VERSION=$(node -p "require('./package.json').version")
tar -czf "mt-prism-${VERSION}-dist.tar.gz" \
  dist/ \
  package.json \
  .env.example \
  README.md \
  LICENSE

# 4. Generate checksum
shasum -a 256 "mt-prism-${VERSION}-dist.tar.gz" > "mt-prism-${VERSION}-dist.tar.gz.sha256"

# 5. Push tag
git push origin "v${VERSION}"

# 6. Create GitHub Release
gh release create "v${VERSION}" \
  --title "MT-PRISM v${VERSION}" \
  --notes "$(cat CHANGELOG.md | sed -n '/## v'${VERSION}'/,/## v/p' | head -n -1)" \
  "mt-prism-${VERSION}-dist.tar.gz" \
  "mt-prism-${VERSION}-dist.tar.gz.sha256"
```

## Post-Release Verification

- [ ] Download tarball from release page
- [ ] Verify checksum matches
- [ ] Test curl install with new version:
  ```bash
  curl -fsSL ... | sh -s -- --version {VERSION}
  ```
- [ ] Verify `prism --version` shows correct version
- [ ] Run smoke test: `prism --help`

## Troubleshooting

**Issue**: Curl install fails with "version not found"
- **Fix**: Verify release is published (not draft)
- **Fix**: Verify tarball asset is uploaded

**Issue**: Checksum verification fails
- **Fix**: Regenerate checksum file
- **Fix**: Ensure no modifications after checksum creation

**Issue**: npm install fails
- **Fix**: Verify dist/ directory is in tarball
- **Fix**: Check package.json is included
